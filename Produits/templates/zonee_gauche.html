{% load static %}


<style>
 .sidebar {
  top: 0;
  left: 0;
  height: 100vh; /* Hauteur pleine de l'écran */
  width: 250px; /* Largeur de la sidebar */

  padding-top: 20px;
  overflow-y: auto; /* Ajoute une barre de défilement verticale */
  
}
/* Conteneur de l'icône de notification */
.notification-icon-container {
    position: relative; /* Nécessaire pour positionner le badge en relatif par rapport à l'icône */
    display: inline-block; /* Permet d'encapsuler le badge et l'icône ensemble */
}

/* Badge de notification */
#notification-count {
    position: absolute;
    top: -3px; /* Ajustez pour positionner le badge au-dessus de l'icône */
    right: 5px; /* Ajustez pour l'aligner sur le côté droit */
    background-color: red; /* Fond rouge */
    color: white; /* Texte blanc */
    font-size: 12px; /* Taille du texte */
    font-weight: 900;
    border-radius: 48%; /* Forme ronde */
    width: 26px; /* Taille du badge */
    height: 18px;
    display: none; /* Par défaut, on le cache */
    justify-content: center;
    align-items: center;
    display: flex; /* Centrage du texte */
    text-align: center;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.2); /* Petit ombrage */
}

/* Afficher le badge si non vide */
#notification-count:not(:empty) {
    display: flex; /* Affiche le badge uniquement s'il y a un contenu */
}

/* Stylisation de l'icône de la cloche */
.feather-bell {
    position: relative;
    font-size: 18px; /* Ajustez selon vos besoins */
}


</style>
<div class="app-container" overflow >
  
  <div class="sidebar">
    <div class="sidebar-header">
      <div class="app-icon">
        <a href="{% url 'acc'  %}">
          <img src="{{ parametre.logo.url }}" alt="" width="50px">
        </a>  
        
      </div>
    </div>
    <ul class="sidebar-list">
      <li class="sidebar-list-item">
        <a href="{% url 'acc' %}">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#2A9D8F" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                <polyline points="9 22 9 12 15 12 15 22"/>
            </svg>
            <span>Home</span>
        </a>
    </li>
    
    <li class="sidebar-list-item">
        <a href="{% url 'home' %}">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#4CAF50" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus-square">
                <path d="M19 12h-6m0 0H7m6 0V7m0 5v5"/>
            </svg>
            <span>Listes des Médicaments</span>
        </a>
    </li>
    
      <li class="sidebar-list-item active">
        <a href="{% url 'produits' %}">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#4CAF50" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-shopping-cart">
                <circle cx="9" cy="21" r="1"/>
                <circle cx="20" cy="21" r="1"/>
                <path d="M5 2h14l-1 7H6L5 2z"/>
                <path d="M6 9l1 11h10l1-11"/>
            </svg>
            <span>Stocks</span>
        </a>
    </li>
    
    <li class="sidebar-list-item">
      <a href="{% url 'historique_ventes' %}">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#4CAF50" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bar-chart">
              <line x1="12" y1="20" x2="12" y2="10"/>
              <line x1="6" y1="20" x2="6" y2="4"/>
              <line x1="18" y1="20" x2="18" y2="2"/>
          </svg>
          <span>Historiques des ventes</span>
      </a>
  </li>
  
  <li class="sidebar-list-item">
    <a href="{% url 'historique_achats' %}">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#4CAF50" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-package">
            <path d="M16 5v14l-4-2-4 2V5l4 2 4-2z"/>
            <path d="M12 13l4 2 4-2V5l-4 2-4-2v10z"/>
        </svg>
        <span>Historiques des Achats</span>
    </a>
</li>

<li class="sidebar-list-item">
  <a href="{% url 'historique_commande' %}">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#FF5722" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M4 4h16v16H4z" />
          <path d="M4 4v16" />
          <line x1="8" y1="8" x2="16" y2="8" />
          <line x1="8" y1="12" x2="16" y2="12" />
          <line x1="8" y1="16" x2="12" y2="16" />
      </svg>
      <span>Bon de commande</span>
  </a>
</li>

<li class="sidebar-list-item">
  <a href="{% url 'historique_devis' %}">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#FF5722" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard">
          <rect x="4" y="2" width="16" height="20" rx="2" ry="2" />
          <path d="M9 2h6v4H9z" />
      </svg>
      <span>Devis</span>
  </a>
</li>

<li class="sidebar-list-item">
  <a href="{% url 'rapports_statistiques' %}">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#FF5722" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bar-chart">
          <line x1="12" y1="20" x2="12" y2="10" />
          <line x1="18" y1="20" x2="18" y2="4" />
          <line x1="6" y1="20" x2="6" y2="16" />
      </svg>
      <span>Rapports et Statistiques</span>
  </a>
</li>

{% if is_admin %}
<li class="sidebar-list-item">
  <a href="{% url 'parametre' %}">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#FF5722" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-settings">
          <circle cx="12" cy="12" r="3"/>
          <path d="M19.4 15.7l-1.5-1.3a6.5 6.5 0 0 0 0-2.8l1.5-1.3a9 9 0 0 0-2.5-3.7l-1.9 1a6.5 6.5 0 0 0-2.5-2.5l-.3-2.1a9 9 0 0 0-3.7 0l-.3 2.1a6.5 6.5 0 0 0-2.5 2.5l-1.9-1a9 9 0 0 0-2.5 3.7l1.5 1.3a6.5 6.5 0 0 0 0 2.8l-1.5 1.3a9 9 0 0 0 2.5 3.7l1.9-1a6.5 6.5 0 0 0 2.5 2.5l.3 2.1a9 9 0 0 0 3.7 0l.3-2.1a6.5 6.5 0 0 0 2.5-2.5l1.9 1a9 9 0 0 0 2.5-3.7z"/>
      </svg>
      <span>Paramètre</span>
  </a>
</li>
{% endif %}

<li class="sidebar-list-item">
  <a href="{% url 'notifications' %}">
      <div class="notification-icon-container">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#FF5722" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bell">
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
              <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
          </svg>
          <span id="notification-count" class="badge">{{ unread_count }}</span>
      </div>
      <span>Notifications</span>
  </a>
</li>

<li class="sidebar-list-item">
    <a href="{% url 'contact' %}">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#FF5722" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-headphones">
            <path d="M12 1C8.69 1 6 3.69 6 7v10c0 3.31 2.69 6 6 6s6-2.69 6-6V7c0-3.31-2.69-6-6-6zM12 19c-1.66 0-3-1.34-3-3h6c0 1.66-1.34 3-3 3z"></path>
        </svg>
        <span>Support</span>
    </a>
</li>

{% if is_admin %}
<li class="sidebar-list-item">
  <a href="{% url 'admin_dashboard' %}">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#FF5722" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user">
          <circle cx="12" cy="12" r="10"></circle>
          <path d="M12 12c2.28 0 4-1.72 4-4s-1.72-4-4-4-4 1.72-4 4 1.72 4 4 4z"></path>
          <path d="M14.4 15.2c-1.2 0-2.4-.8-2.4-1.6 0-.8 1.2-1.6 2.4-1.6z"></path>
      </svg>
      <span>Administrateur</span>
  </a>
</li>
{% endif %}

   
    </ul>
    <div class="account-info">
      <div class="account-info-picture">

        {% if user.is_authenticated %}
        <a href="{% url 'deconnection' %}">
          
       
          <img src="{% static 'logo.png' %}" alt="" width="50px">
      </div>
      <div class="account-info-name">{{request.user }} </div>
    </a>
    {% endif %}
      <button class="account-info-more">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/></svg>
      </button>
    </div>
  </div>
  <script>
    // Fonction pour récupérer le nombre de notifications non lues via AJAX
    function updateNotificationCount() {
        fetch('{% url "notifications" %}', {
            method: 'GET',
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            // Mettre à jour le badge avec le nombre de notifications non lues
            const notificationCount = data.unread_count;
            const badge = document.getElementById('notification-count');
            if (notificationCount > 0) {
                badge.textContent = notificationCount;  // Affiche le nombre
                badge.style.display = 'inline';  // Assurez-vous que le badge est visible
            } else {
                badge.style.display = 'none';  // Masquer le badge si aucune notification non lue
            }
        })
        .catch(error => console.error('Error fetching notifications:', error));
    }

    // Mettre à jour le nombre de notifications dès que le DOM est prêt
    document.addEventListener('DOMContentLoaded', function() {
        updateNotificationCount();
    });

    // Vous pouvez également mettre à jour les notifications après un certain intervalle
    setInterval(updateNotificationCount, 30000);  // Mettre à jour toutes les 30 secondes
</script>
